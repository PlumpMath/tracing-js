<!doctype html>
<html>
	<head>
		<title>.trace</title>
		<meta charset="utf-8" />
		<style type="text/css">
			.line { margin-left: 1ex; width: 80ex; }
			.current-line { background-color: #ddd; }
		</style>
	</head>

	<body>
		<div id="trace"></div>

		<script src="util.js"></script>
		<script src="trace.js"></script>

		<script src="search_naive.js"></script>
		<script src="search_naive.trace.js"></script>

		<script src="lib/react.js"></script>
		<script src="trace-ui.js"></script>
		<script>
			var code = "var pattern = \"Wor\";\nvar string  = \"Hello, World!\";\n\nfor (var i = 0; i < string.length; i++) {\n\tvar j = 0;\n\twhile (j < pattern.length && pattern[j] == string[i + j]) {\n\t\tj++;\n\t}\n\n\tif (j == pattern.length) {\n\t\tconsole.log(\"found match at \" + j);\n\t}\n}\n";
			var rollup = currentTrace.rollup();

			var traceEl = document.getElementById("trace");
			var traceComponent = React.renderComponent(TraceUI2({code: code, trace: rollup[0]}), traceEl);

			var pos = 0;
			function renderPos() {
				traceComponent.setProps({trace: rollup[pos]});
			}

			document.onkeydown = function(ev) {
				switch (ev.keyCode) {
					case 37:
						pos = Math.max(0, pos - 1);
						renderPos();
						break;
					case 39:
						pos = Math.min(rollup.length - 1, pos + 1);
						renderPos();
						break;
				}
			}
		</script>
	</body>
</html>
